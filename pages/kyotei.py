import streamlit as st
import random
import datetime

# ---------------------------
# ğŸ“… æ—¥ä»˜ã¨æ™‚åˆ»
# ---------------------------
jst_now = datetime.datetime.utcnow() + datetime.timedelta(hours=9)
today_str = jst_now.strftime("%Y%m%d")
time_now = jst_now.strftime("%Y-%m-%d %H:%M:%S")

# ---------------------------
# Streamlitè¨­å®š
# ---------------------------
st.set_page_config(page_title="ç«¶è‰‡AIäºˆæƒ³", layout="wide")
st.title("ğŸš¤ ç«¶è‰‡AIäºˆæƒ³ - å‡ºèµ°è¡¨ï¼‹äºˆæƒ³çµæœ")
st.write(f"ğŸ“… æœ¬æ—¥ï¼š{today_str}")
st.write(f"ğŸ•’ ç¾åœ¨æ™‚åˆ»ï¼ˆæ—¥æœ¬æ™‚é–“ï¼‰ï¼š{time_now}")

# ---------------------------
# ä»®ã®ãƒ¬ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿
# ---------------------------
races = [
    {
        "ãƒ¬ãƒ¼ã‚¹å": "ç¬¬1R äºˆé¸",
        "é–‹å‚¬åœ°": "è’²éƒ¡",
        "é¸æ‰‹": ["ä»Šå£å…‰å¤ªéƒ", "ç™½äº•è‹±æ²»", "å³°ç«œå¤ª", "æ¯’å³¶èª ", "ç“œç”Ÿæ­£ç¾©", "å¹³æœ¬çœŸä¹‹"]
    },
    {
        "ãƒ¬ãƒ¼ã‚¹å": "ç¬¬2R ä¸€èˆ¬",
        "é–‹å‚¬åœ°": "ä¸¸äº€",
        "é¸æ‰‹": ["æ¡ç”Ÿé †å¹³", "èµ¤å²©å–„ç”Ÿ", "æ¾äº•ç¹", "çŸ³é‡è²´ä¹‹", "å²¡å´æ­è£•", "äº•å£ä½³å…¸"]
    },
    {
        "ãƒ¬ãƒ¼ã‚¹å": "ç¬¬3R æº–å„ªå‹æˆ¦",
        "é–‹å‚¬åœ°": "å¸¸æ»‘",
        "é¸æ‰‹": ["å¯ºç”°ç¥¥", "æ¿±é‡è°·æ†²å¾", "è¥¿å±±è²´æµ©", "ç¯ å´å…ƒå¿—", "å‰æœ¬æ³°å’Œ", "èŒ…åŸæ‚ ç´€"]
    }
]

# ---------------------------
# ä»®AIäºˆæƒ³ãƒ­ã‚¸ãƒƒã‚¯
# ---------------------------
def predict_ai(players):
    shuffled = players.copy()
    random.shuffle(shuffled)
    return f"ğŸ¯ äºˆæƒ³ï¼š{shuffled[0]} â†’ {shuffled[1]} â†’ {shuffled[2]}"

# ---------------------------
# è¡¨ç¤º
# ---------------------------
for race in races:
    st.markdown("---")
    st.subheader(f"ğŸ {race['ãƒ¬ãƒ¼ã‚¹å']} @ {race['é–‹å‚¬åœ°']}")
    st.write("### ğŸš© å‡ºèµ°è¡¨")
    for i, player in enumerate(race["é¸æ‰‹"], start=1):
        st.write(f"{i}å·è‰‡ï¼š{player}")
    st.write("### ğŸ¤– AIäºˆæƒ³")
    prediction = predict_ai(race["é¸æ‰‹"])
    st.success(prediction)

st.caption("â€» ç¾åœ¨ã¯ä»®ã®AIãƒ­ã‚¸ãƒƒã‚¯ã‚’ä½¿ç”¨ä¸­ã§ã™ã€‚ä»Šå¾Œã€æœ¬ç‰©ã®AIå­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼ˆLightGBMãªã©ï¼‰ã«é€²åŒ–äºˆå®šã€‚")
